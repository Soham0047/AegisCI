# Vulnerability Categories Reference

## Injection Vulnerabilities

### SQL Injection (SQLi)
- **CWE-89**: Improper Neutralization of Special Elements used in an SQL Command
- **Risk**: Data theft, data manipulation, authentication bypass
- **Detection**: Look for string concatenation in SQL queries
- **Fix**: Use parameterized queries, prepared statements, or ORMs

### Command Injection
- **CWE-78**: Improper Neutralization of Special Elements used in an OS Command
- **Risk**: Remote code execution, system compromise
- **Detection**: Look for shell=True, os.system(), exec(), spawn()
- **Fix**: Use array arguments, avoid shell interpretation

### LDAP Injection
- **CWE-90**: Improper Neutralization of Special Elements used in an LDAP Query
- **Risk**: Authentication bypass, information disclosure
- **Detection**: Look for string concatenation in LDAP filters
- **Fix**: Escape special characters, use parameterized queries

### XPath Injection
- **CWE-643**: Improper Neutralization of Data within XPath Expressions
- **Risk**: Data extraction, authentication bypass
- **Detection**: Look for user input in XPath queries
- **Fix**: Use parameterized XPath APIs

## Cross-Site Scripting (XSS)

### Reflected XSS
- **CWE-79**: Improper Neutralization of Input During Web Page Generation
- **Risk**: Session hijacking, credential theft
- **Detection**: User input reflected in HTML response
- **Fix**: Output encoding, Content Security Policy

### Stored XSS
- **CWE-79**: Same as reflected, but persisted
- **Risk**: Widespread impact, malware distribution
- **Detection**: Stored data rendered without escaping
- **Fix**: Sanitize on input, encode on output

### DOM-based XSS
- **CWE-79**: Client-side script execution
- **Risk**: Same as reflected XSS
- **Detection**: innerHTML, document.write, eval with user input
- **Fix**: Use textContent, sanitization libraries

## Authentication & Session

### Broken Authentication
- **CWE-287**: Improper Authentication
- **Risk**: Account takeover, unauthorized access
- **Detection**: Weak passwords, missing MFA, session fixation
- **Fix**: Strong auth, MFA, secure session management

### Session Fixation
- **CWE-384**: Session Fixation
- **Risk**: Account hijacking
- **Detection**: Session ID not regenerated after login
- **Fix**: Regenerate session ID on authentication state change

### Credential Exposure
- **CWE-798**: Use of Hard-coded Credentials
- **CWE-312**: Cleartext Storage of Sensitive Information
- **Risk**: Unauthorized access
- **Detection**: Hardcoded passwords, API keys in code
- **Fix**: Use environment variables, secrets managers

## Cryptographic Issues

### Weak Hashing
- **CWE-328**: Reversible One-Way Hash
- **Risk**: Password cracking
- **Detection**: MD5, SHA1 for passwords
- **Fix**: Use bcrypt, argon2, scrypt

### Insufficient Entropy
- **CWE-330**: Use of Insufficiently Random Values
- **Risk**: Predictable tokens, session IDs
- **Detection**: Use of random module for security
- **Fix**: Use secrets module, crypto libraries

### Broken Crypto
- **CWE-327**: Use of a Broken or Risky Cryptographic Algorithm
- **Risk**: Data exposure
- **Detection**: DES, RC4, ECB mode
- **Fix**: Use AES-GCM, ChaCha20-Poly1305

## Path Traversal & File Handling

### Path Traversal
- **CWE-22**: Improper Limitation of a Pathname to a Restricted Directory
- **Risk**: Arbitrary file read/write
- **Detection**: User input in file paths without validation
- **Fix**: Validate path is within allowed directory

### Unrestricted File Upload
- **CWE-434**: Unrestricted Upload of File with Dangerous Type
- **Risk**: Remote code execution
- **Detection**: Missing file type validation
- **Fix**: Validate content type, store outside webroot

## Deserialization

### Insecure Deserialization
- **CWE-502**: Deserialization of Untrusted Data
- **Risk**: Remote code execution
- **Detection**: pickle.load, yaml.load, unserialize with user data
- **Fix**: Use safe alternatives, validate before deserializing

## Information Disclosure

### Error Message Exposure
- **CWE-209**: Generation of Error Message Containing Sensitive Information
- **Risk**: Information leakage
- **Detection**: Stack traces, SQL errors in responses
- **Fix**: Generic error messages, log details server-side

### Sensitive Data Exposure
- **CWE-200**: Exposure of Sensitive Information to an Unauthorized Actor
- **Risk**: Privacy violation, compliance issues
- **Detection**: PII in logs, unencrypted storage
- **Fix**: Encrypt data, minimize data collection

## Access Control

### Insecure Direct Object References (IDOR)
- **CWE-639**: Authorization Bypass Through User-Controlled Key
- **Risk**: Unauthorized data access
- **Detection**: Sequential IDs without authorization check
- **Fix**: Verify authorization for each access

### Missing Function Level Access Control
- **CWE-285**: Improper Authorization
- **Risk**: Privilege escalation
- **Detection**: Admin functions accessible without auth check
- **Fix**: Enforce authorization at function level

## Server-Side Request Forgery (SSRF)

### SSRF
- **CWE-918**: Server-Side Request Forgery
- **Risk**: Internal network access, cloud metadata exposure
- **Detection**: User-controlled URLs in server requests
- **Fix**: URL allowlisting, block internal IPs
